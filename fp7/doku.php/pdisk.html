<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
  <title>  StratusLab :: Persistent disk  </title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="Author" content="Marcin Mierzejewski @ Zenzire"/>
  <meta name="Keywords" content="StratusLab,Persistent disk"/>
  <meta name="Description" content="StratusLabPersistent disk"/>
  <meta name="generator" content="DokuWiki" />
<meta name="robots" content="index,follow" />
<meta name="date" content="2012-01-19T11:59:38+0100" />
<meta name="keywords" content="pdisk" />
<link rel="search" type="application/opensearchdescription+xml" href="../lib/exe/opensearch.php" title="StratusLab" />
<link rel="start" href="../index.html" />
<link rel="contents" href="pdisk.html?do=index" title="Sitemap" />
<link rel="canonical" href="pdisk.html" />
<link rel="stylesheet" media="screen" type="text/css" href="../lib/exe/css.php?t=stratuslab-theme&amp;tseed=1349958590" />
<link rel="stylesheet" media="all" type="text/css" href="../lib/exe/css.php?s=all&amp;t=stratuslab-theme&amp;tseed=1349958590" />
<link rel="stylesheet" media="print" type="text/css" href="../lib/exe/css.php?s=print&amp;t=stratuslab-theme&amp;tseed=1349958590" />
<script type="text/javascript" ><!--//--><![CDATA[//><!--
var NS='';var JSINFO = {"id":"pdisk","namespace":""};
//--><!]]></script>
<script type="text/javascript" charset="utf-8" src="../lib/exe/js.php?tseed=1349958590" ></script>
  <link rel="alternate" type="application/rss+xml" title="News"
     href="../feed.php?ns=news.html&amp;linkto=page" />

  <link rel="stylesheet" media="screen" type="text/css" href="../lib/tpl/stratuslab-theme/css/design.css" />
  <link rel="stylesheet" media="screen" type="text/css" href="../lib/tpl/stratuslab-theme/css/gallery.css" />
  <link rel="stylesheet" type="text/css" href="../lib/tpl/stratuslab-theme/css/960.css" media="screen" />

  <script type="text/javascript">

   var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-18570821-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();

</script>
</head>

<body>
  <div class="Page">
		<div class="Header">

			<div class="Banner">
			      </div>

			<div class="MenuContainer"><div class="Menu" id="level1">
<p>

<!-- main menu under the banner -->
<div class="mainmenu">
<span class="menuitem">
<a class="menulink" href="../index.php">Home</a>
</span>
<span class="menuitem">
<a class="menulink" href="./release:install.html">Install</a>
</span>
<span class="menuitem">
<a class="menulink" href="support.html">Support</a>
</span>
<span class="menuitem">
<a class="menulink" href="documentation.html">Documentation</a>
</span>
<span class="menuitem">
<a class="menulink" href="./roadmap:project_roadmap.html">Roadmap</a>
</span>
<span class="menuitem">
<a class="menulink" href="news.html">News</a>
</span>
<span class="menuitem">
<a class="menulink" href="./project:info.html">About</a>
</span>
</div>


</p>
</div><div class="Menu" id="level2"></div>
		</div> 


    	
		<div class="Content">
				<!-- TOC START -->
<div class="toc">
<div class="tocheader toctoggle" id="toc__header">Table of Contents</div>
<div id="toc__inside">

<ul class="toc">
<li class="level1"><div class="li"><span class="li"><a href="pdisk.html#persistent_disk" class="toc">Persistent disk</a></span></div>
<ul class="toc">
<li class="level2"><div class="li"><span class="li"><a href="pdisk.html#available_features" class="toc">Available features</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="pdisk.html#rest_api" class="toc">Rest API</a></span></div>
<ul class="toc">
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#get_all_disks_properties" class="toc">Get all disks properties</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#get_a_single_disk_properties" class="toc">Get a single disk properties</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#remove_a_disk" class="toc">Remove a disk</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#create_a_disk" class="toc">Create a disk</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#hot-plug_disk_attachment" class="toc">Hot-plug disk attachment</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#hot-plug_disk_detachment" class="toc">Hot-plug disk detachment</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#disk_attachment_registration" class="toc">Disk attachment registration</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#disk_detachment_registration" class="toc">Disk detachment registration</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="pdisk.html#client_errors" class="toc">Client errors</a></span></div></li></ul>
</li></ul>
</li></ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1"><a name="persistent_disk" id="persistent_disk">Persistent disk</a></h1>
<div class="level1">

<p>

<strong>Persistent Storage</strong> provides on-site management of persistent storage areas (a la Amazon Elastic Block Store) allowing users to create disks of a given size, to launch a machine with the disks attached, and to persist the disks after their use, so that the disks are available for use by another machine instance.
</p>

</div>

<h2 class="sectionedit2"><a name="available_features" id="available_features">Available features</a></h2>
<div class="level2">

</div>

<h4><a name="users_features" id="users_features">Users features</a></h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Create persistent disk from 1GB to 1TB that you can mount on a StratusLab instance.</div>
</li>
<li class="level1"><div class="li"> Persistent disk behave like raw, unformatted block device. You can create a file system on top of this disk or use them in any other way you would use a block device (like a hard drive). </div>
</li>
<li class="level1"><div class="li"> Persistent disk a created on a specific storage area and can be used in every StratusLab cloud.</div>
</li>
<li class="level1"><div class="li"> When creating a disk, you can choose the visibility of it. It can be private, you will be the only one able to view it in the disk list, read it, write it and delete it. The disk can also be public, then other users can view it in the disk list, read it, write it but you are the only one able to delete it.</div>
</li>
<li class="level1"><div class="li"> Persistent disks can be hot-plugged to a running instance, no need to restart it to use a disk.</div>
</li>
<li class="level1"><div class="li"> You can attach many disk as you want on a machine. This means that you can strip your data across them for increased I/O and throughput performance. This is particularly helpful for database style applications that frequently encounter many random reads and writes across the dataset. </div>
</li>
</ul>

</div>

<h4><a name="administrator_features" id="administrator_features">Administrator features</a></h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Disk across storage area and the VM node a shared with iSCSI or NFS.</div>
</li>
<li class="level1"><div class="li"> Persistent disk can be either LVM partition or simple block file</div>
</li>
<li class="level1"><div class="li"> Properties of persistent disk are stored in Hadoop Zookeeper, which automatically allow fault tolerance with redundancy.</div>
</li>
<li class="level1"><div class="li"> This service is independent from a cloud installation, you don&#039;t need to have a cloud frontend install on the same machine or in your farm to run it.</div>
</li>
<li class="level1"><div class="li"> Simultaneous users on a disk can be limited to avoid i/o errors.</div>
</li>
</ul>

</div>

<h2 class="sectionedit3"><a name="rest_api" id="rest_api">Rest API</a></h2>
<div class="level2">

<p>

The persistent disk <acronym title="Application Programming Interface">API</acronym> provide a simple way to interact with it in programs. The <acronym title="Application Programming Interface">API</acronym> URLs starts with <code>/api/</code> and has no ending slash.
</p>

</div>

<h3 class="sectionedit4"><a name="get_all_disks_properties" id="get_all_disks_properties">Get all disks properties</a></h3>
<div class="level3">

<p>

List disks properties available for a user.

</p>
<pre class="code"> GET /api/disks</pre>

</div>

<h4><a name="response" id="response">Response</a></h4>
<div class="level4">

<p>

<code>Status: 200 OK</code>

</p>
<pre class="code"> [
     {
         &quot;users&quot;: &quot;0&quot;,
         &quot;created&quot;: &quot;2011/07/28 15:01:40&quot;,
         &quot;visibility&quot;: &quot;private&quot;,
         &quot;tag&quot;: &quot;a simple disk&quot;,
         &quot;owner&quot;: &quot;test&quot;,
         &quot;uuid&quot;: &quot;eb198dec-3560-4a9a-b3b4-5f043410a3dd&quot;,
         &quot;size&quot;: &quot;2&quot;
     },
     {
         &quot;users&quot;: &quot;0&quot;,
         &quot;created&quot;: &quot;2011/07/28 15:01:54&quot;,
         &quot;visibility&quot;: &quot;public&quot;,
         &quot;tag&quot;: &quot;a public disk&quot;,
         &quot;owner&quot;: &quot;test&quot;,
         &quot;uuid&quot;: &quot;7d409aed-3207-4dd1-85f3-3bca3605b1fb&quot;,
         &quot;size&quot;: &quot;1&quot;
     }
 ]</pre>

</div>

<h3 class="sectionedit5"><a name="get_a_single_disk_properties" id="get_a_single_disk_properties">Get a single disk properties</a></h3>
<div class="level3">
<pre class="code"> GET /api/disks/:uuid</pre>

</div>

<h4><a name="response1" id="response1">Response</a></h4>
<div class="level4">

<p>

<code>Status: 200 OK</code>
</p>

<p>
<code>X-DiskUser-Limit: 2</code>
</p>

<p>
<code>X-DiskUser-Remaining: 1</code>
</p>
<pre class="code"> {
    &quot;users&quot;: &quot;1&quot;,
    &quot;created&quot;: &quot;2011/07/28 15:01:40&quot;,
    &quot;visibility&quot;: &quot;private&quot;,
    &quot;tag&quot;: &quot;a simple disk&quot;,
    &quot;owner&quot;: &quot;test&quot;,
    &quot;uuid&quot;: &quot;eb198dec-3560-4a9a-b3b4-5f043410a3dd&quot;,
    &quot;size&quot;: &quot;2&quot;
 }
 </pre>

<p>
Disk user limit and disk user remaining for a disk are send in the <acronym title="Hyper Text Transfer Protocol">HTTP</acronym> headers as <code>X-DiskUser-Limit</code> and <code>X-DiskUser-Remaining</code>. Client should not try to attach a disk which as less than one remaining disk user.
</p>

</div>

<h3 class="sectionedit6"><a name="remove_a_disk" id="remove_a_disk">Remove a disk</a></h3>
<div class="level3">
<pre class="code"> DELETE /api/disks/:uuid</pre>

</div>

<h4><a name="response2" id="response2">Response</a></h4>
<div class="level4">

<p>

<code>Status: 200 OK</code>

</p>
<pre class="code"> { &quot;uuid&quot;: &quot;eb198dec-3560-4a9a-b3b4-5f043410a3dd&quot; }</pre>

</div>

<h3 class="sectionedit7"><a name="create_a_disk" id="create_a_disk">Create a disk</a></h3>
<div class="level3">
<pre class="code"> POST /api/create</pre>

</div>

<h4><a name="input" id="input">Input</a></h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> <em>size</em>: Size of the disk in GiBs. Between 1 and 1024.</div>
</li>
<li class="level1"><div class="li"> <em>tag</em>: Tag of the  disk.</div>
</li>
<li class="level1"><div class="li"> <em>visibility</em>: Visibility of the disk. Can be <code>private</code> or <code>public</code>.</div>
</li>
</ul>

<p>

All of the inputs are required.
</p>

</div>

<h4><a name="response3" id="response3">Response</a></h4>
<div class="level4">

<p>

<code>Status: 201 Created</code>

</p>
<pre class="code"> { &quot;uuid&quot;: &quot;a00539f7-d40d-4d8d-95c0-5b0c9713c92e&quot; }</pre>

<p>

The returned content is the UUID of the newly created persistent disk.
</p>

</div>

<h3 class="sectionedit8"><a name="hot-plug_disk_attachment" id="hot-plug_disk_attachment">Hot-plug disk attachment</a></h3>
<div class="level3">
<pre class="code"> POST /api/hotattach/:uuid</pre>

</div>

<h4><a name="input1" id="input1">Input</a></h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> <em>node</em>: Node on which the VM is running.</div>
</li>
<li class="level1"><div class="li"> <em>vm_id</em>: Identifier of the VM on which the disk is attached.</div>
</li>
</ul>

</div>

<h4><a name="response4" id="response4">Response</a></h4>
<div class="level4">

<p>

<code>Status: 200 OK</code>

</p>
<pre class="code"> { 
   &quot;node&quot;: &quot;onehost-2.lal.in2p3.fr&quot;,
   &quot;vm_id&quot;: &quot;722&quot;,
   &quot;target&quot;: &quot;vda&quot;,
   &quot;uuid&quot;: [&quot;a00539f7-d40d-4d8d-95c0-5b0c9713c92e&quot;, &quot;eb198dec-3560-4a9a-b3b4-5f043410a3dd&quot;]
 }</pre>

<p>

The returned UUIDs are all the disk that are attached to the VM.
</p>

</div>

<h3 class="sectionedit9"><a name="hot-plug_disk_detachment" id="hot-plug_disk_detachment">Hot-plug disk detachment</a></h3>
<div class="level3">
<pre class="code"> POST /api/hotdetach/:uuid</pre>

<p>

Only hot-plugged disk can be detached with this method.
</p>

</div>

<h4><a name="input2" id="input2">Input</a></h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> <em>node</em>: Node on which the VM is running.</div>
</li>
<li class="level1"><div class="li"> <em>vm_id</em>: Identifier of the VM on which the disk is attached.</div>
</li>
</ul>

</div>

<h4><a name="response5" id="response5">Response</a></h4>
<div class="level4">

<p>

<code>Status: 200 OK</code>

</p>
<pre class="code"> { 
   &quot;node&quot;: &quot;onehost-2.lal.in2p3.fr&quot;,
   &quot;vm_id&quot;: &quot;722&quot;,
   &quot;target&quot;: &quot;vda&quot;,
   &quot;uuid&quot;: [&quot;a00539f7-d40d-4d8d-95c0-5b0c9713c92e&quot;, &quot;eb198dec-3560-4a9a-b3b4-5f043410a3dd&quot;]
 }</pre>

<p>

The returned UUIDs are the remaining attached disks on the VM.
</p>

</div>

<h3 class="sectionedit10"><a name="disk_attachment_registration" id="disk_attachment_registration">Disk attachment registration</a></h3>
<div class="level3">

<p>

<em>This method is intended to be used by the cloud frontend.</em>

</p>
<pre class="code"> POST /api/attach/:uuid</pre>

<p>

This method will not check disk availability, it have to be done by the client before launching a VM.
</p>

<p>
Disk attached this way can only be removed when the VM is killed.
</p>

</div>

<h4><a name="input3" id="input3">Input</a></h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> <em>node</em>: Node on which the VM is running.</div>
</li>
<li class="level1"><div class="li"> <em>vm_id</em>: Identifier of the VM on which the disk is attached.</div>
</li>
</ul>

</div>

<h4><a name="response6" id="response6">Response</a></h4>
<div class="level4">

<p>

<code>Status: 200 OK</code>

</p>
<pre class="code"> { 
   &quot;node&quot;: &quot;onehost-2.lal.in2p3.fr&quot;,
   &quot;vm_id&quot;: &quot;722&quot;,
   &quot;uuid&quot;: [&quot;a00539f7-d40d-4d8d-95c0-5b0c9713c92e&quot;, &quot;eb198dec-3560-4a9a-b3b4-5f043410a3dd&quot;]
 }</pre>

<p>

The returned UUIDs are all the disk that are attached to the VM.
</p>

</div>

<h3 class="sectionedit11"><a name="disk_detachment_registration" id="disk_detachment_registration">Disk detachment registration</a></h3>
<div class="level3">

<p>

<em>This method is intended to be used by the cloud frontend.</em>

</p>
<pre class="code"> POST /api/detach</pre>

<p>

This method should be called only when the VM is killed.
</p>

</div>

<h4><a name="input4" id="input4">Input</a></h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> <em>node</em>: Node on which the VM is running.</div>
</li>
<li class="level1"><div class="li"> <em>vm_id</em>: Identifier of the VM on which the disk is attached.</div>
</li>
</ul>

</div>

<h4><a name="response7" id="response7">Response</a></h4>
<div class="level4">

<p>

<code>Status: 200 OK</code>

</p>
<pre class="code"> { 
   &quot;node&quot;: &quot;onehost-2.lal.in2p3.fr&quot;,
   &quot;vm_id&quot;: &quot;722&quot;,
   &quot;uuid&quot;: [&quot;a00539f7-d40d-4d8d-95c0-5b0c9713c92e&quot;, &quot;eb198dec-3560-4a9a-b3b4-5f043410a3dd&quot;]
 }</pre>

<p>

The returned UUIDs are all the disk that have been detached from the VM.
</p>

</div>

<h3 class="sectionedit12"><a name="client_errors" id="client_errors">Client errors</a></h3>
<div class="level3">

<p>

Client error on <acronym title="Application Programming Interface">API</acronym> calls are returned with either a <code>400 Bad Request</code> or a <code> 422 Unprocessable Entity</code> response.
Error messages as structured as follows:

</p>
<pre class="code"> {&quot;message&quot;: [&quot;First error message&quot;, &quot;Second error message&quot;] }</pre>

</div>

		</div>
  
    
        <div class="stylefoot">
      <div class="meta">
        <div class="doc">
	  <!--
          pdisk.txt &middot; Last modified: 2012/01/19 11:59 (external edit)	  -->
        </div>
        <div class="user">
                  </div>
      </div>
          </div>
    
<div class="container_12" id="footer">

<div class="clear">&nbsp;</div>
<div class="footspacer">&nbsp;</div>


<div class="grid_2 push_10 omega">
<a class="footerlink" href="./mailto:info@stratuslab.eu">General queries</a><br>
<a class="footerlink" href="./mailto:support@stratuslab.eu">Support queries</a>
<div class="clear">&nbsp;</div>
<div class="spacer">&nbsp;</div>
<a class="footerlink" href="internal.html">Go to project internal pages</a> 
</div>

<div class="clear">&nbsp;</div>
<div class="spacer">&nbsp;</div>




<div class="clear">&nbsp;</div>
<div class="spacer">&nbsp;</div>


<div class="grid_1 push_2 alpha">
<div class="partnerlink">
<a class="imagelink" href="./project:cnrs.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/cnrs-logo.png"></a></a>
<a class="partnerlink" href="./project:cnrs.html">CNRS</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:grnet.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/grnet-logo.png"></a><br>
<a class="partnerlink" href="./project:grnet.html">GRNET</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:sixsq.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/sixsq-logo.png"></a><br>
<a class="partnerlink" href="./project:sixsq.html">SixSq SÃ rl</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:ucm.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/ucm-logo.png"></a><br>
<a class="partnerlink" href="./project:ucm.html">UCM</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:tid.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/tid-logo.png"></a><br>
<a class="partnerlink" href="./project:tid.html">TID</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:tcd.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/tcd-logo.png"></a><br>
<a class="partnerlink" href="./project:tcd.html">TCD</a>
</div>
</div>
<div class="grid_1 push_4 omega">
<img src="../lib/tpl/stratuslab-theme/images/FP7-cap-CMYK.png">
</div>
<div class="grid_1 push_4">
<img src="../lib/tpl/stratuslab-theme/images/eu-flag-blue-yellow.png">
</div>
<!-- <div class="grid_2 push_3 omega">
<img src="images/e-infrastructure-logo.png">
</div> -->

<div class="spacer">&nbsp;</div>
<div class="grid_10 push_2">
The StratusLab project is co-funded by the European Community's Seventh Framework Programme (Capacities) Grant Agreement INFSO-RI-261552.
</div>
<div class="clear">&nbsp;</div>
<div class="spacer">&nbsp;</div>


</div> <!-- end container_12 div -->

	    </div>
</body>
</html>
