<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
  <title>  StratusLab :: Appliance Repository  </title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="Author" content="Marcin Mierzejewski @ Zenzire"/>
  <meta name="Keywords" content="StratusLab,Appliance Repository"/>
  <meta name="Description" content="StratusLabAppliance Repository"/>
  <meta name="generator" content="DokuWiki" />
<meta name="robots" content="index,follow" />
<meta name="date" content="2012-01-19T11:59:38+0100" />
<meta name="keywords" content="apprepository" />
<link rel="search" type="application/opensearchdescription+xml" href="../lib/exe/opensearch.php" title="StratusLab" />
<link rel="start" href="../index.html" />
<link rel="contents" href="apprepository.html?do=index" title="Sitemap" />
<link rel="canonical" href="apprepository.html" />
<link rel="stylesheet" media="screen" type="text/css" href="../lib/exe/css.php?t=stratuslab-theme&amp;tseed=1349958590" />
<link rel="stylesheet" media="all" type="text/css" href="../lib/exe/css.php?s=all&amp;t=stratuslab-theme&amp;tseed=1349958590" />
<link rel="stylesheet" media="print" type="text/css" href="../lib/exe/css.php?s=print&amp;t=stratuslab-theme&amp;tseed=1349958590" />
<script type="text/javascript" ><!--//--><![CDATA[//><!--
var NS='';var JSINFO = {"id":"apprepository","namespace":""};
//--><!]]></script>
<script type="text/javascript" charset="utf-8" src="../lib/exe/js.php?tseed=1349958590" ></script>

  <link rel="stylesheet" media="screen" type="text/css" href="../lib/tpl/stratuslab-theme/css/design.css" />
  <link rel="stylesheet" media="screen" type="text/css" href="../lib/tpl/stratuslab-theme/css/gallery.css" />
  <link rel="stylesheet" type="text/css" href="../lib/tpl/stratuslab-theme/css/960.css" media="screen" />

  <script type="text/javascript">

   var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-18570821-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();

</script>
</head>

<body>
  <div class="Page">
		<div class="Header">

			<div class="Banner">
			      </div>

			<div class="MenuContainer"><div class="Menu" id="level1">
<p>

<!-- main menu under the banner -->
<div class="mainmenu">
<span class="menuitem">
<a class="menulink" href="../index.html">Home</a>
</span>
<span class="menuitem">
<a class="menulink" href="./release:install.html">Install</a>
</span>
<span class="menuitem">
<a class="menulink" href="support.html">Support</a>
</span>
<span class="menuitem">
<a class="menulink" href="documentation.html">Documentation</a>
</span>
<span class="menuitem">
<a class="menulink" href="./roadmap:project_roadmap.html">Roadmap</a>
</span>
<span class="menuitem">
<a class="menulink" href="news.html">News</a>
</span>
<span class="menuitem">
<a class="menulink" href="./project:info.html">About</a>
</span>
</div>


</p>
</div><div class="Menu" id="level2"></div>
		</div> 


    	
		<div class="Content">
				
<h1 class="sectionedit1"><a name="appliance_repository" id="appliance_repository">Appliance Repository</a></h1>
<div class="level1">

<p>

The StratusLab project maintains a prototype appliance repository via which machine images can be shared.  The images are available via the http(s) protocol.  The service is connected to the project&#039;s <acronym title="Lightweight Directory Access Protocol">LDAP</acronym> server with write access controlled via username/password.
</p>

<p>
The repository can be browsed with a standard web server at the address: <a href="http://appliances.stratuslab.eu/images" class="urlextern" title="http://appliances.stratuslab.eu/images"  rel="nofollow">http://appliances.stratuslab.eu/images</a>. 
</p>

<p>
The appliance repository structure is designed to mirror that of a Maven repository. Images are organised by type and operating system, for example:

</p>
<pre class="code">    grid
      |
      - ce
         |
          - sl-5.5-x86_64-grid.ce
                     |
                      - 1.0
                        |
                         - sl-5.5-x86_64-grid.ce-1.0.img</pre>

<p>

In order to maintain compatibility with Maven, image filenames must follow the following pattern:

</p>
<ul>
<li class="level1"><div class="li"> &lt;os&gt;-&lt;osversion&gt;-&lt;arch&gt;-&lt;type&gt;-&lt;imageversion&gt;.&lt;ext&gt;</div>
</li>
</ul>

<p>

Current types are: grid.ce,grid.se,grid.ui, for specialised grid images; and base, for standard <acronym title="Operating System">OS</acronym> images.
</p>

<p>
Uploading/Downloading to/from the repository can be performed using standard tools such as Curl. When uploading use your <acronym title="Lightweight Directory Access Protocol">LDAP</acronym> username and password.
</p>

<p>
To upload the following command would be used:

</p>
<ul>
<li class="level1"><div class="li"> curl -T &lt;image&gt; -u &lt;username&gt; https://appliances.stratuslab.eu/images/&lt;imagedirectory&gt;/</div>
</li>
</ul>

<p>

When uploading it may be necessary to create directories if the required directory structure does not exist. This can also be done with Curl:

</p>
<ul>
<li class="level1"><div class="li"> curl -X MKCOL -u &lt;username&gt; https://appliances.stratuslab.eu/images/a/direc/tory/</div>
</li>
</ul>

<p>

However, as the above command is not recursive, it may be more convenient to use a WebDAV client, such as Cadaver, or a browser with WebDav functionality to create directory structures. When creating directories the following structure must be followed:

</p>
<pre class="code">   &lt;type&gt;
      |
       - &lt;os&gt;-&lt;osversion&gt;-&lt;arch&gt;-&lt;type&gt;
                      |
                       - &lt;imageversion&gt;</pre>

<p>

Here, the top level directory, &lt;type&gt;, should be split into a hierarchy if necessary, e.g., grid.ce becomes grid/ce.
</p>

<p>
To download:

</p>
<ul>
<li class="level1"><div class="li"> curl http://appliances.stratuslab.eu/images/.../&lt;image&gt; -o &lt;image_filename&gt;</div>
</li>
</ul>

</div>

<h1 class="sectionedit2"><a name="appliance_repository_installation" id="appliance_repository_installation">Appliance Repository Installation</a></h1>
<div class="level1">

<p>

The Appliance Repository is a WebDAV-enabled Apache webserver. Access control is managed by the central StratusLab <acronym title="Lightweight Directory Access Protocol">LDAP</acronym> server.
</p>

<p>
The first step is to install the Apache webserver. If you are using yum this is straightforward:

</p>
<ul>
<li class="level1"><div class="li"> yum install httpd</div>
</li>
</ul>

<p>

The WebDAV module must then be enabled in the httpd.conf. The exact details will vary depending on your <acronym title="Operating System">OS</acronym> and version of Apache, but the basic steps are to add:

</p>
<pre class="code">   LoadModule dav_module modules/mod_dav.so</pre>

<p>

and to specify the location of the DAVLock file:

</p>
<pre class="code">   DAVLockDB /var/lib/dav/lockdb
   </pre>

<p>
The following configuration (/etc/httpd/conf.d/webdav-ldap,conf) can then be used to setup WebDAV on a particular directory (in this example /images), using <acronym title="Lightweight Directory Access Protocol">LDAP</acronym> authentication:

</p>
<pre class="code">   Alias /images &quot;/images&quot;
   LDAPVerifyServerCert on
   LDAPTrustedGlobalCert CA_BASE64 /etc/httpd/sslcert/stratuslab-ldap.pem
   LDAPTrustedMode SSL
   &lt;Directory /images&gt;
      Dav On
      Options +Indexes
      IndexOptions FancyIndexing
      AddDefaultCharset UTF-8
      AuthType Basic
      AuthName &quot;Image Repository Access&quot;
      AuthLDAPURL &quot;ldaps://ldap.stratuslab.eu:10636/ou=people,o=stratuslab?uid&quot;
      AuthBasicProvider ldap
      AuthzLDAPAuthoritative off
      AuthLDAPBindDN &quot;cn=repo,ou=daemons,o=stratuslab&quot;
      AuthLDAPBindPassword xxxxxxxx
      &lt;Limit PUT POST DELETE PROPPATCH MKCOL COPY MOVE LOCK UNLOCK&gt;
              Require valid-user
      &lt;/Limit&gt;
      Order allow,deny
      Allow from all
  &lt;/Directory&gt;
  </pre>

<p>
LDAPTrustedGlobalCert, AuthLDAPURL, AuthLDAPBindDN, AuthLDAPBindPassword should be modified to contain the correct values for your <acronym title="Lightweight Directory Access Protocol">LDAP</acronym> server.
</p>

<p>
The final step is to create the following file, stratuslab.repo.cfg, in a .stratuslab directory, located in the base directory of the repository (i.e. /images in the example configuration above):

</p>
<pre class="code">  [stratuslab_repo]
  repo_structure = #type_#/#os#-#osversion#-#arch#-#type#/#version#
  repo_filename = #os#-#osversion#-#arch#-#type#-#version#.img.#compression#</pre>

</div>

		</div>
  
    
        <div class="stylefoot">
      <div class="meta">
        <div class="doc">
	  <!--
          apprepository.txt &middot; Last modified: 2012/01/19 11:59 (external edit)	  -->
        </div>
        <div class="user">
                  </div>
      </div>
          </div>
    
<div class="container_12" id="footer">

<div class="clear">&nbsp;</div>
<div class="footspacer">&nbsp;</div>


<div class="grid_2 push_10 omega">
<a class="footerlink" href="mailto:info@stratuslab.eu">General queries</a><br>
<a class="footerlink" href="mailto:support@stratuslab.eu">Support queries</a>
<div class="clear">&nbsp;</div>
<div class="spacer">&nbsp;</div>
<a class="footerlink" href="internal.html">Go to project internal pages</a> 
</div>

<div class="clear">&nbsp;</div>
<div class="spacer">&nbsp;</div>




<div class="clear">&nbsp;</div>
<div class="spacer">&nbsp;</div>


<div class="grid_1 push_2 alpha">
<div class="partnerlink">
<a class="imagelink" href="./project:cnrs.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/cnrs-logo.png"></a></a>
<a class="partnerlink" href="./project:cnrs.html">CNRS</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:grnet.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/grnet-logo.png"></a><br>
<a class="partnerlink" href="./project:grnet.html">GRNET</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:sixsq.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/sixsq-logo.png"></a><br>
<a class="partnerlink" href="./project:sixsq.html">SixSq Sàrl</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:ucm.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/ucm-logo.png"></a><br>
<a class="partnerlink" href="./project:ucm.html">UCM</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:tid.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/tid-logo.png"></a><br>
<a class="partnerlink" href="./project:tid.html">TID</a>
</div>
</div>
<div class="grid_1 push_2">
<div class="partnerlink">
<a class="imagelink" href="./project:tcd.html"><img src="../lib/tpl/stratuslab-theme/images/partnerlogos/tcd-logo.png"></a><br>
<a class="partnerlink" href="./project:tcd.html">TCD</a>
</div>
</div>
<div class="grid_1 push_4 omega">
<img src="../lib/tpl/stratuslab-theme/images/FP7-cap-CMYK.png">
</div>
<div class="grid_1 push_4">
<img src="../lib/tpl/stratuslab-theme/images/eu-flag-blue-yellow.png">
</div>
<!-- <div class="grid_2 push_3 omega">
<img src="images/e-infrastructure-logo.png">
</div> -->

<div class="spacer">&nbsp;</div>
<div class="grid_10 push_2">
The StratusLab project is co-funded by the European Community's Seventh Framework Programme (Capacities) Grant Agreement INFSO-RI-261552.
</div>
<div class="clear">&nbsp;</div>
<div class="spacer">&nbsp;</div>


</div> <!-- end container_12 div -->

	    </div>
</body>
</html>
